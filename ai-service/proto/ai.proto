syntax = "proto3";

package ai;

// Request to analyze daily journal notes
message DailyAnalysisRequest {
  string user_id = 1;
  string date = 2; // ISO date string (YYYY-MM-DD)
  repeated JournalNote notes = 3;
}

// Request to analyze weekly journal (from daily summaries)
message WeeklyAnalysisRequest {
  string user_id = 1;
  string week_start = 2; // ISO date string
  string week_end = 3;   // ISO date string
  repeated DailySummary daily_summaries = 4;
}

// A single journal note
message JournalNote {
  int64 id = 1;
  string title = 2;
  string body = 3;
  string created_at = 4; // ISO datetime string
}

// A daily summary (used for weekly aggregation)
message DailySummary {
  string date = 1;
  string summary = 2;
  string dominant_mood = 3;
  int32 mood_score = 4; // 0-100
  repeated string highlights = 5;
  repeated string advice = 6;
  int32 note_count = 7;
}

// Analysis result returned by both daily and weekly RPCs
message AnalysisResult {
  string summary = 1;
  string dominant_mood = 2;
  int32 mood_score = 3; // 0-100, 0 if unknown
  repeated string highlights = 4;
  repeated string advice = 5;
  string affirmation = 6;
}

// AI Analysis Service
service AIAnalysisService {
  // Analyze a single day's journal notes
  rpc AnalyzeDaily (DailyAnalysisRequest) returns (AnalysisResult);

  // Analyze a week based on daily summaries
  rpc AnalyzeWeekly (WeeklyAnalysisRequest) returns (AnalysisResult);
}
